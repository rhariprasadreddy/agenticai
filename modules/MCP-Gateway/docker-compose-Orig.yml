services:
  mcp-gateway:
    build: .
    container_name: mcp-gateway
    environment:
      ORCH_URL: http://mcp-orchestrator:8081
      API_KEY: dev-key
    ports:
      - "8080:8080"
    depends_on:
      - mcp-orchestrator

  mcp-orchestrator:
    image: python:3.11-slim
    container_name: mcp-orchestrator
    working_dir: /app
    volumes:
      - ./orchestrator_stub.py:/app/orchestrator_stub.py:ro
    command: >
      sh -c "pip install -q fastapi uvicorn &&
             uvicorn orchestrator_stub:app --host 0.0.0.0 --port 8081"
    ports:
      - "8081:8081"